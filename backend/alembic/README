# Alembic Database Migrations

This directory contains database migration scripts for the Enterprise Image Generation Platform.

## Creating Migrations

### Auto-generate migration from model changes:
```bash
alembic revision --autogenerate -m "Description of changes"
```

### Create empty migration:
```bash
alembic revision -m "Description of changes"
```

## Running Migrations

### Upgrade to latest version:
```bash
alembic upgrade head
```

### Upgrade by one revision:
```bash
alembic upgrade +1
```

### Downgrade by one revision:
```bash
alembic downgrade -1
```

### Downgrade to specific revision:
```bash
alembic downgrade <revision_id>
```

## Viewing History

### Show current revision:
```bash
alembic current
```

### Show migration history:
```bash
alembic history --verbose
```

## Best Practices

1. **Always review autogenerated migrations** - Alembic may not detect all changes correctly
2. **Test migrations** - Test both upgrade and downgrade paths
3. **Use transactions** - Migrations run in transactions by default
4. **Data migrations** - For complex data migrations, create custom migration scripts
5. **Backup before production** - Always backup production database before migrating

## ISO 27001 Compliance

- All migrations are versioned and tracked
- Downgrade paths ensure recoverability
- Migration history provides audit trail
- Database changes require code review

Control: A.12.3.1 - Information backup
